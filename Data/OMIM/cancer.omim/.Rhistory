heatmap.2(hallmark.matrix, col=my_palette, trace='none', breaks=colors,
key.xlab=NA, key.title="Interaction Z-scores Heatmap",
key.ylab=NA, key.xtickfun = NULL, key.ytickfun = NULL,
#srtCol=45, adjCol=c(1,0),
dendrogram = "row",
margins=c(14,18.5), sepwidth=c(0.01,0.01), #symbreaks = TRUE,
sepcolor="grey", colsep=1:hallmark.dim, rowsep=1:hallmark.dim)
#keysize=1, key.par=list(mar=c(2,1,2,2)))
#lmat=rbind( c(0, 3, 4), c(2,1,1.5)), lwid=c(3, 4, 2))
#lmat=rbind(c(5, 4, 2), c(6, 1, 3)), lhei=c(2, 5), lwid=c(1, 10, 1))
dev.off()
jaccard <- overlap.matrix
colnames(jaccard) <- c(1:50)
row.names(jaccard) <- c(1:50)
png("hallmark.jaccard.new.png", width=12, height=11, res=600, units="in")
heatmap.2(jaccard, col=my_palette, trace='none', breaks=colors,
key.xlab=NA, key.title="Jaccard Index Heatmap",
key.ylab=NA, key.xtickfun = NULL, key.ytickfun = NULL,
#srtCol=45, adjCol=c(1,0),
dendrogram = "row",
margins=c(14.5,18), sepwidth=c(0.01,0.01), #symbreaks = TRUE,
sepcolor="grey", colsep=1:50, rowsep=1:50)
dev.off()
my_palette <- colorRampPalette(c("white", "red2"))(n = 20)
colors = c(seq(0,0.1,length=21))
jaccard <- overlap.matrix
colnames(jaccard) <- c(1:50)
row.names(jaccard) <- c(1:50)
png("hallmark.jaccard.new.png", width=12, height=11, res=600, units="in")
heatmap.2(jaccard, col=my_palette, trace='none', breaks=colors,
key.xlab=NA, key.title="Jaccard Index Heatmap",
key.ylab=NA, key.xtickfun = NULL, key.ytickfun = NULL,
#srtCol=45, adjCol=c(1,0),
dendrogram = "row",
margins=c(14.5,18), sepwidth=c(0.01,0.01), #symbreaks = TRUE,
sepcolor="grey", colsep=1:50, rowsep=1:50)
dev.off()
png("hallmark.jaccard.new2.png", width=12, height=4, res=600, units="in")
heatmap.2(jaccard, col=my_palette, trace='none', breaks=colors,
key.xlab=NA, key.title="Jaccard Index Heatmap",
key.ylab=NA, key.xtickfun = NULL, key.ytickfun = NULL,
#srtCol=45, adjCol=c(1,0),
dendrogram = "row",
margins=c(14.5,18), sepwidth=c(0.01,0.01), #symbreaks = TRUE,
sepcolor="grey", colsep=1:50, rowsep=1:50)
dev.off()
png("hhi.z.heatmap.new2.png", width=12, height=4, res=600, units="in")
heatmap.2(hallmark.matrix, col=my_palette, trace='none', breaks=colors,
key.xlab=NA, key.title="Interaction Z-score Heatmap",
key.ylab=NA, key.xtickfun = NULL, key.ytickfun = NULL,
#srtCol=45, adjCol=c(1,0),
dendrogram = "row",
margins=c(14,18.5), sepwidth=c(0.01,0.01), #symbreaks = TRUE,
sepcolor="grey", colsep=1:hallmark.dim, rowsep=1:hallmark.dim)
#keysize=1, key.par=list(mar=c(2,1,2,2)))
#lmat=rbind( c(0, 3, 4), c(2,1,1.5)), lwid=c(3, 4, 2))
#lmat=rbind(c(5, 4, 2), c(6, 1, 3)), lhei=c(2, 5), lwid=c(1, 10, 1))
dev.off()
gene.12[which(gene.12 %in% gene.25)]
2/348
hhi.z[12,15]
hhi.z[12,25]
my_palette <- colorRampPalette(c("blue2", "white", "red2"))(n = 20)
#colors= c(seq(-5,-1.5, length=10), seq(-1.49, 1.49, length=10), seq(1.5,5, length=10))
colors = c(seq(-10,10,length=21))
png("hhi.z.heatmap.new2.png", width=12, height=4, res=600, units="in")
heatmap.2(hallmark.matrix, col=my_palette, trace='none', breaks=colors,
key.xlab=NA, key.title="Interaction Z-score Heatmap",
key.ylab=NA, key.xtickfun = NULL, key.ytickfun = NULL,
#srtCol=45, adjCol=c(1,0),
dendrogram = "row",
margins=c(14,18.5), sepwidth=c(0.01,0.01), #symbreaks = TRUE,
sepcolor="grey", colsep=1:hallmark.dim, rowsep=1:hallmark.dim)
#keysize=1, key.par=list(mar=c(2,1,2,2)))
#lmat=rbind( c(0, 3, 4), c(2,1,1.5)), lwid=c(3, 4, 2))
#lmat=rbind(c(5, 4, 2), c(6, 1, 3)), lhei=c(2, 5), lwid=c(1, 10, 1))
dev.off()
overlap.matrix[7,37]
hhi.z[7,37]
hhi.z.nodiag[7,37]
hallmark.matrix[7,37]
hallmark.matrix[6,37]
hallmark.matrix[7,37]
source('~/Documents/GitHub/NetBAS/NetBAS/Data/OMIM/random/random15-200/rri.15-200.R')
#
library(gplots) #for heatmap.2
list <- c(1:50)
random.dim <- 50
rri.dat <- read.csv("rri.z.csv", header=F, stringsAsFactors = F)
rri.z <- matrix(unlist(rri.dat), nrow=random.dim, ncol=random.dim)
colnames(rri.z) <- list
rownames(rri.z) <- list
my_palette <- colorRampPalette(c("blue2", "white", "red2"))(n = 20)
#colors= c(seq(-5,-1.5, length=10), seq(-1.49, 1.49, length=10), seq(1.5,5, length=10))
colors = c(seq(-10,10,length=21))
png("rri15-200.z.heatmap.png", width=12, height=11, res=600, units="in")
heatmap.2(rri.z, col=my_palette, trace='none', breaks=colors,
key.xlab=NA, key.title="Z-score", key.ylab=NA, key.xtickfun = NULL, key.ytickfun = NULL,
#srtCol=45, adjCol=c(1,0), dendrogram = "both",
margins=c(14,18.5), sepwidth=c(0.01,0.01), symbreaks = TRUE,
sepcolor="grey", colsep=1:random.dim, rowsep=1:random.dim)
dev.off()
rri.z.mat <- as.matrix(rri.z)
rri.z.net <- graph.adjacency(rri.z.mat, mode="undirected", weighted=T, diag=F)
top2 <- quantile(rri.z, probs=seq(0,1,1/50))[50]
bottom2 <- quantile(rri.z, probs=seq(0,1,1/50))[2]
E(rri.z.net)$color <- ifelse(E(rri.z.net)$weight > 0, "red", "blue")
coloring <- E(rri.z.net)$color
rri.weight <- ifelse((E(rri.z.net)$weight > 5 | (E(rri.z.net)$weight < bottom2)),
abs(E(rri.z.net)$weight), -0.5)
pdf("rri15-200.z.network.pdf", height=8, width=8, paper='special')
plot.igraph(rri.z.net, vertex.label=c(1:50), layout=layout_in_circle,
edge.color = coloring, edge.width=rri.weight)
dev.off()
setwd("../random/random15-200/")
#
library(gplots) #for heatmap.2
list <- c(1:50)
random.dim <- 50
rri.dat <- read.csv("rri.z.csv", header=F, stringsAsFactors = F)
rri.z <- matrix(unlist(rri.dat), nrow=random.dim, ncol=random.dim)
colnames(rri.z) <- list
rownames(rri.z) <- list
my_palette <- colorRampPalette(c("blue2", "white", "red2"))(n = 20)
#colors= c(seq(-5,-1.5, length=10), seq(-1.49, 1.49, length=10), seq(1.5,5, length=10))
colors = c(seq(-10,10,length=21))
png("rri15-200.z.heatmap.png", width=12, height=11, res=600, units="in")
heatmap.2(rri.z, col=my_palette, trace='none', breaks=colors,
key.xlab=NA, key.title="Z-score", key.ylab=NA, key.xtickfun = NULL, key.ytickfun = NULL,
#srtCol=45, adjCol=c(1,0), dendrogram = "both",
margins=c(14,18.5), sepwidth=c(0.01,0.01), symbreaks = TRUE,
sepcolor="grey", colsep=1:random.dim, rowsep=1:random.dim)
dev.off()
rri.z.mat <- as.matrix(rri.z)
rri.z.net <- graph.adjacency(rri.z.mat, mode="undirected", weighted=T, diag=F)
top2 <- quantile(rri.z, probs=seq(0,1,1/50))[50]
bottom2 <- quantile(rri.z, probs=seq(0,1,1/50))[2]
E(rri.z.net)$color <- ifelse(E(rri.z.net)$weight > 0, "red", "blue")
coloring <- E(rri.z.net)$color
rri.weight <- ifelse((E(rri.z.net)$weight > 5 | (E(rri.z.net)$weight < bottom2)),
abs(E(rri.z.net)$weight), -0.5)
pdf("rri15-200.z.network.pdf", height=8, width=8, paper='special')
plot.igraph(rri.z.net, vertex.label=c(1:50), layout=layout_in_circle,
edge.color = coloring, edge.width=rri.weight)
dev.off()
#
library(gplots) #for heatmap.2
list <- c(1:50)
random.dim <- 50
rri.dat <- read.csv("rri.z.csv", header=F, stringsAsFactors = F)
rri.z <- matrix(unlist(rri.dat), nrow=random.dim, ncol=random.dim)
colnames(rri.z) <- list
rownames(rri.z) <- list
my_palette <- colorRampPalette(c("blue2", "white", "red2"))(n = 20)
#colors= c(seq(-5,-1.5, length=10), seq(-1.49, 1.49, length=10), seq(1.5,5, length=10))
colors = c(seq(-10,10,length=21))
png("rri15-200.z.heatmap.png", width=12, height=11, res=600, units="in")
heatmap.2(rri.z, col=my_palette, trace='none', breaks=colors,
key.xlab=NA, key.title="Z-score", key.ylab=NA, key.xtickfun = NULL, key.ytickfun = NULL,
#srtCol=45, adjCol=c(1,0), dendrogram = "both",
margins=c(14,18.5), sepwidth=c(0.01,0.01), symbreaks = TRUE,
sepcolor="grey", colsep=1:random.dim, rowsep=1:random.dim)
dev.off()
rri.z.mat <- as.matrix(rri.z)
rri.z.net <- graph.adjacency(rri.z.mat, mode="undirected", weighted=T, diag=F)
top2 <- quantile(rri.z, probs=seq(0,1,1/50))[50]
bottom2 <- quantile(rri.z, probs=seq(0,1,1/50))[2]
E(rri.z.net)$color <- ifelse(E(rri.z.net)$weight > 0, "red", "blue")
coloring <- E(rri.z.net)$color
rri.weight <- ifelse((E(rri.z.net)$weight > 5 | (E(rri.z.net)$weight < -5)),
abs(E(rri.z.net)$weight), -0.5)
pdf("rri15-200.z.network.pdf", height=8, width=8, paper='special')
plot.igraph(rri.z.net, vertex.label=c(1:50), layout=layout_in_circle,
edge.color = coloring, edge.width=rri.weight)
dev.off()
png("rri15-200.z.heatmap.new2.png", width=12, height=4, res=600, units="in")
heatmap.2(rri.z, col=my_palette, trace='none', breaks=colors,
key.xlab=NA, key.title="Z-score", key.ylab=NA, key.xtickfun = NULL, key.ytickfun = NULL,
#srtCol=45, adjCol=c(1,0), dendrogram = "both",
margins=c(14,18.5), sepwidth=c(0.01,0.01), symbreaks = TRUE,
sepcolor="grey", colsep=1:random.dim, rowsep=1:random.dim)
dev.off()
png("rri15-200.z.heatmap.new2.png", width=12, height=4, res=600, units="in")
heatmap.2(rri.z, col=my_palette, trace='none', breaks=colors,
key.xlab=NA, key.title="Interaction Z-score Heatmap", key.ylab=NA, key.xtickfun = NULL, key.ytickfun = NULL,
#srtCol=45, adjCol=c(1,0), dendrogram = "both",
margins=c(14,18.5), sepwidth=c(0.01,0.01), symbreaks = TRUE,
sepcolor="grey", colsep=1:random.dim, rowsep=1:random.dim)
dev.off()
median(rri.z)
mean(rri.z)
mean(hhi.z)
median(rri.z)
median(hhi.z)
rri.z.mat <- as.matrix(rri.z)
rri.z.net <- graph.adjacency(rri.z.mat, mode="undirected", weighted=T, diag=F)
top2 <- quantile(rri.z, probs=seq(0,1,1/50))[50]
bottom2 <- quantile(rri.z, probs=seq(0,1,1/50))[2]
E(rri.z.net)$color <- ifelse(E(rri.z.net)$weight > 0, "red", "blue")
coloring <- E(rri.z.net)$color
rri.weight <- ifelse((E(rri.z.net)$weight > 2 | (E(rri.z.net)$weight < -2)),
abs(E(rri.z.net)$weight), -0.5)
pdf("rri15-200.z.network.pdf", height=8, width=8, paper='special')
plot.igraph(rri.z.net, vertex.label=c(1:50), layout=layout_in_circle,
edge.color = coloring, edge.width=rri.weight)
dev.off()
pdf("rri15-200.z.network.pdf", height=8, width=8, paper='special')
plot.igraph(rri.z.net, vertex.label=c(1:50), layout=layout_in_circle,
edge.color = coloring, edge.width=rri.weight/4)
dev.off()
getwd()
size.file <- read.csv("set.size.csv", header=T)
sizes <- size.file$size
sizes
pdf("rri15-200.z.network.pdf", height=8, width=8, paper='special')
plot.igraph(rri.z.net, vertex.label=c(1:50), layout=layout_in_circle,
edge.color = coloring, edge.width=rri.weight/4, vertex.size=sqrt(sizes)*1.2)
dev.off()
pdf("rri15-200.z.network.pdf", height=8, width=8, paper='special')
plot.igraph(rri.z.net, vertex.label=c(1:50), layout=layout_in_circle,
edge.color = coloring, edge.width=rri.weight/4, vertex.size=sqrt(sizes-1)*1.2)
dev.off()
rri.nodiag <- rri.z
diag(rri.nodiag) <- NA
boxplot(rri.nodiag)
par(mar=c(15,5,1,1))
boxplot(rri.nodiag, main="Random-Random Z-score BoxPlot", xaxt="n", col='brown')
text(seq(1,50), par("usr")[3]-1, srt=45, adj=1, xpd=T,
labels=c(1:50), cex=0.8)
par(mar=c(15,5,1,1))
boxplot(rri.nodiag, main="Random-Random Z-score BoxPlot", xaxt="n", col='brown')
text(seq(1,50), par("usr")[3]-1, srt=0, adj=1, xpd=T,
labels=c(1:50), cex=0.8)
par(mar=c(15,5,1,1))
boxplot(rri.nodiag, main="Random-Random Z-score BoxPlot", xaxt="n", col='brown')
text(seq(1,50), par("usr")[2]-1, srt=0, adj=1, xpd=T,
labels=c(1:50), cex=0.8)
par(mar=c(15,5,1,1))
boxplot(rri.nodiag, main="Random-Random Z-score BoxPlot", xaxt="n", col='brown')
text(seq(1,50), par("usr")[3]-0.5, srt=0, adj=1, xpd=T,
labels=c(1:50), cex=0.8)
par(mar=c(15,5,1,1))
boxplot(rri.nodiag, main="Random-Random Z-score BoxPlot", xaxt="n", col='brown')
text(seq(1,50), par("usr")[3]-0.5, srt=-45, adj=1, xpd=T,
labels=c(1:50), cex=0.8)
par(mar=c(15,5,1,1))
boxplot(rri.nodiag, main="Random-Random Z-score BoxPlot", xaxt="n", col='brown')
text(seq(1,50), par("usr")[3]-1, srt=-45, adj=1, xpd=T,
labels=c(1:50), cex=0.8)
boxplot(rri.nodiag, main="Random-Random Z-score BoxPlot", xaxt="n", col='brown')
text(seq(1,50), par("usr")[3]-0.5, srt=-45, adj=1, xpd=T,
labels=c(1:50), cex=0.75)
pdf("rri.z.boxplot.nodiag.pdf", height=6, width=15, paper='special')
par(mar=c(15,5,1,1))
boxplot(rri.nodiag, main="Random-Random Z-score BoxPlot", xaxt="n", col='brown')
text(seq(1,50), par("usr")[3]-0.5, srt=-45, adj=1, xpd=T,
labels=c(1:50), cex=0.75)
dev.off()
pdf("rri.z.boxplot.nodiag.pdf", height=6, width=10, paper='special')
par(mar=c(15,5,1,1))
boxplot(rri.nodiag, main="Random-Random Z-score BoxPlot", xaxt="n", col='brown')
text(seq(1,50), par("usr")[3]-0.5, srt=-45, adj=1, xpd=T,
labels=c(1:50), cex=0.75)
dev.off()
pdf("rri.z.boxplot.nodiag.pdf", height=4, width=8, paper='special')
par(mar=c(15,5,1,1))
boxplot(rri.nodiag, main="Random-Random Z-score BoxPlot", xaxt="n", col='brown')
text(seq(1,50), par("usr")[3]-0.5, srt=-45, adj=1, xpd=T,
labels=c(1:50), cex=0.75)
dev.off()
pdf("rri.z.boxplot.nodiag.pdf", height=6, width=8, paper='special')
par(mar=c(15,5,1,1))
boxplot(rri.nodiag, main="Random-Random Z-score BoxPlot", xaxt="n", col='brown')
text(seq(1,50), par("usr")[3]-0.5, srt=-45, adj=1, xpd=T,
labels=c(1:50), cex=0.75)
dev.off()
length(rri.nodiag > 2)
length(which(rri.nodiag > 2))
length(which(hallmark.matrix > 2))
length(which(hallmark.matrix > 5))
cancer <- read.csv("cancer.gene.csv", header=T, stringsAsFactors = F)
cancer.name <- unique(cancer$NAME[!is.na(cancer$SN)])
#calculate association between a pair of two cancers
cancer.dim <- length(cancer.name)
cci.dat <- read.csv("cci.z.csv", header=F, stringsAsFactors = F)
cci.z <- matrix(unlist(cci.dat), nrow=cancer.dim, ncol=cancer.dim)
colnames(cci.z) <- cancer.name
rownames(cci.z) <- cancer.name
my_palette <- colorRampPalette(c("blue2", "white", "red2"))(n = 20)
colors= c(seq(-8,8, length=21))
png("cci.z.heatmap.png", width=12, height=11, res=600, units="in")
heatmap.2(cci.z, col=my_palette, trace='none', breaks=colors,
key.xlab=NA, key.title="Z-score", key.ylab=NA, key.xtickfun = NULL, key.ytickfun = NULL,
srtCol=45, adjCol=c(1,0), dendrogram = "both",
margins=c(14,18.5), sepwidth=c(0.01,0.01), symbreaks = TRUE,
sepcolor="grey", colsep=1:length(cancer.name), rowsep=1:length(cancer.name))
dev.off()
cci.z.mat <- as.matrix(cci.z)
cci.z.net <- graph.adjacency(cci.z.mat, mode="undirected", weighted=T, diag=F)
E(cci.z.net)$color <- ifelse(E(cci.z.net)$weight > 0, "brown", "green")
coloring <- E(cci.z.net)$color
cci.weight <- ifelse(abs(E(cci.z.net)$weight) > 1.6449, abs(E(cci.z.net)$weight), -0.5)
# in two-tailed test Z > 1.96 corresponds to p < 0.05
# Z > 1.6449 is for p < 0.10
# Z > 1.2819 for p < 0.10 in one-tailed test
# Z > 1.6449 for p < 0.50 in one-tailed test
radi <- c()
for (i in 1:length(cancer.name)) {
radi <- rbind(radi, sqrt(length(which(cancer$NAME %in% cancer.name[i]))))
}
black.id <- c(1:13)
blue.id <- c(14:16)
red.id <- c(18,17,19)
sub.order <- V(cci.z.net)[c(red.id, black.id, blue.id)]
coords <- layout_in_circle(cci.z.net, order = sub.order)
color <- rep("NA", times=19)
color[red.id] <- rep("red", times=length(red.id))
color[blue.id] <- rep("blue", times=length(blue.id))
color[black.id] <- rep("grey", times=length(black.id))
V(cci.z.net)$color <- color
pdf("cci.net.pdf", width=8, height=8, paper='special')
plot.igraph(cci.z.net, layout=coords, cex=0.6,
edge.color = coloring, edge.width=cci.weight*1.5, vertex.size=radi*6)
dev.off()
cci.z.nodiag <- cci.z
diag(cci.z.nodiag) <- NA
pdf("cci.z.boxplot.pdf", height=4, width=6, paper='special')
par(mar=c(8,3,1,1))
boxplot(cci.z.nodiag, main="Z-score Box Plot",
space=0, xaxt="n", col='brown')
text(seq(1,19), par("usr")[3]-0.25, srt=45, adj=1, xpd=T,
col='blue',labels=cancer.name, cex=1)
dev.off()
getwd()
setwd("../../cancer.omim/")
library(gplots) #for heatmap.2
cancer <- read.csv("cancer.gene.csv", header=T, stringsAsFactors = F)
cancer.name <- unique(cancer$NAME[!is.na(cancer$SN)])
#calculate association between a pair of two cancers
cancer.dim <- length(cancer.name)
cci.dat <- read.csv("cci.z.csv", header=F, stringsAsFactors = F)
cci.z <- matrix(unlist(cci.dat), nrow=cancer.dim, ncol=cancer.dim)
colnames(cci.z) <- cancer.name
rownames(cci.z) <- cancer.name
my_palette <- colorRampPalette(c("blue2", "white", "red2"))(n = 20)
colors= c(seq(-8,8, length=21))
png("cci.z.heatmap.png", width=12, height=11, res=600, units="in")
heatmap.2(cci.z, col=my_palette, trace='none', breaks=colors,
key.xlab=NA, key.title="Z-score", key.ylab=NA, key.xtickfun = NULL, key.ytickfun = NULL,
srtCol=45, adjCol=c(1,0), dendrogram = "both",
margins=c(14,18.5), sepwidth=c(0.01,0.01), symbreaks = TRUE,
sepcolor="grey", colsep=1:length(cancer.name), rowsep=1:length(cancer.name))
dev.off()
cci.z.mat <- as.matrix(cci.z)
cci.z.net <- graph.adjacency(cci.z.mat, mode="undirected", weighted=T, diag=F)
E(cci.z.net)$color <- ifelse(E(cci.z.net)$weight > 0, "brown", "green")
coloring <- E(cci.z.net)$color
cci.weight <- ifelse(abs(E(cci.z.net)$weight) > 1.6449, abs(E(cci.z.net)$weight), -0.5)
# in two-tailed test Z > 1.96 corresponds to p < 0.05
# Z > 1.6449 is for p < 0.10
# Z > 1.2819 for p < 0.10 in one-tailed test
# Z > 1.6449 for p < 0.50 in one-tailed test
radi <- c()
for (i in 1:length(cancer.name)) {
radi <- rbind(radi, sqrt(length(which(cancer$NAME %in% cancer.name[i]))))
}
black.id <- c(1:13)
blue.id <- c(14:16)
red.id <- c(18,17,19)
sub.order <- V(cci.z.net)[c(red.id, black.id, blue.id)]
coords <- layout_in_circle(cci.z.net, order = sub.order)
color <- rep("NA", times=19)
color[red.id] <- rep("red", times=length(red.id))
color[blue.id] <- rep("blue", times=length(blue.id))
color[black.id] <- rep("grey", times=length(black.id))
V(cci.z.net)$color <- color
pdf("cci.net.pdf", width=8, height=8, paper='special')
plot.igraph(cci.z.net, layout=coords, cex=0.6,
edge.color = coloring, edge.width=cci.weight*1.5, vertex.size=radi*6)
dev.off()
cci.z.nodiag <- cci.z
diag(cci.z.nodiag) <- NA
pdf("cci.z.boxplot.pdf", height=4, width=6, paper='special')
par(mar=c(8,3,1,1))
boxplot(cci.z.nodiag, main="Z-score Box Plot",
space=0, xaxt="n", col='brown')
text(seq(1,19), par("usr")[3]-0.25, srt=45, adj=1, xpd=T,
col='blue',labels=cancer.name, cex=1)
dev.off()
cci.z.mat <- as.matrix(cci.z)
cci.z.net <- graph.adjacency(cci.z.mat, mode="undirected", weighted=T, diag=F)
E(cci.z.net)$color <- ifelse(E(cci.z.net)$weight > 0, "brown", "green")
coloring <- E(cci.z.net)$color
cci.weight <- ifelse(abs(E(cci.z.net)$weight) > 2, abs(E(cci.z.net)$weight), -0.5)
# in two-tailed test Z > 1.96 corresponds to p < 0.05
# Z > 1.6449 is for p < 0.10
# Z > 1.2819 for p < 0.10 in one-tailed test
# Z > 1.6449 for p < 0.50 in one-tailed test
radi <- c()
for (i in 1:length(cancer.name)) {
radi <- rbind(radi, sqrt(length(which(cancer$NAME %in% cancer.name[i]))))
}
black.id <- c(1:13)
blue.id <- c(14:16)
red.id <- c(18,17,19)
sub.order <- V(cci.z.net)[c(red.id, black.id, blue.id)]
coords <- layout_in_circle(cci.z.net, order = sub.order)
color <- rep("NA", times=19)
color[red.id] <- rep("red", times=length(red.id))
color[blue.id] <- rep("blue", times=length(blue.id))
color[black.id] <- rep("grey", times=length(black.id))
V(cci.z.net)$color <- color
pdf("cci.net.pdf", width=8, height=8, paper='special')
plot.igraph(cci.z.net, layout=coords, cex=0.6,
edge.color = coloring, edge.width=cci.weight*1.5, vertex.size=radi*6)
dev.off()
pdf("cci.net.pdf", width=8, height=8, paper='special')
plot.igraph(cci.z.net, layout=coords, cex=0.6, col="grey",
edge.color = coloring, edge.width=cci.weight*1.5, vertex.size=radi*6)
dev.off()
pdf("cci.net.pdf", width=8, height=8, paper='special')
plot.igraph(cci.z.net, layout=coords, cex=0.6, col="grey",
edge.color = coloring, edge.width=cci.weight*1.5, vertex.size=radi*8)
dev.off()
pdf("cci.net.pdf", width=8, height=8, paper='special')
plot.igraph(cci.z.net, layout=coords, cex=0.6, col="red",
edge.color = coloring, edge.width=cci.weight*1.5, vertex.size=radi*8)
dev.off()
pdf("cci.net.pdf", width=8, height=8, paper='special')
plot.igraph(cci.z.net, layout=coords, cex=0.6, color="black",
edge.color = coloring, edge.width=cci.weight*1.5, vertex.size=radi*8)
dev.off()
pdf("cci.net.pdf", width=8, height=8, paper='special')
plot.igraph(cci.z.net, layout=coords, cex=0.6, vertex.color="black",
edge.color = coloring, edge.width=cci.weight*1.5, vertex.size=radi*8)
dev.off()
pdf("cci.net.pdf", width=8, height=8, paper='special')
plot.igraph(cci.z.net, layout=coords, cex=0.6, label.color="black",
edge.color = coloring, edge.width=cci.weight*1.5, vertex.size=radi*8)
dev.off()
pdf("cci.net.pdf", width=8, height=8, paper='special')
plot.igraph(cci.z.net, layout=coords, cex=0.6, label.degree=pi/2,
edge.color = coloring, edge.width=cci.weight*1.5, vertex.size=radi*8)
dev.off()
pdf("cci.net.pdf", width=8, height=8, paper='special')
plot.igraph(cci.z.net, layout=coords, cex=0.6, label.dist=1,
edge.color = coloring, edge.width=cci.weight*1.5, vertex.size=radi*8)
dev.off()
pdf("cci.net.pdf", width=8, height=8, paper='special')
plot.igraph(cci.z.net, layout=coords, cex=0.6, label.dist=1, curved,
edge.color = coloring, edge.width=cci.weight*1.5, vertex.size=radi*8)
dev.off()
pdf("cci.net.pdf", width=8, height=8, paper='special')
plot.igraph(cci.z.net, layout=coords, cex=0.6, label.dist=1, curved=T,
edge.color = coloring, edge.width=cci.weight*1.5, vertex.size=radi*8)
dev.off()
black.id <- c(1:13)
blue.id <- c(14:16)
red.id <- c(18,17,19)
sub.order <- V(cci.z.net)[c(red.id, black.id, blue.id)]
coords <- layout_in_circle(cci.z.net, order = sub.order)
color <- rep("NA", times=19)
color[red.id] <- rep("red", times=length(red.id))
color[blue.id] <- rep("yellow", times=length(blue.id))
color[black.id] <- rep("grey", times=length(black.id))
V(cci.z.net)$color <- color
pdf("cci.net.pdf", width=8, height=8, paper='special')
plot.igraph(cci.z.net, layout=coords, cex=0.6, label.dist=1, curved=T,
edge.color = coloring, edge.width=cci.weight*1.5, vertex.size=radi*8)
dev.off()
pdf("cci.net.pdf", width=8, height=8, paper='special')
plot.igraph(cci.z.net, layout=coords, cex=0.6, edge.color="green",
edge.color = coloring, edge.width=cci.weight*1.5, vertex.size=radi*8)
dev.off()
pdf("cci.net.pdf", width=8, height=8, paper='special')
plot.igraph(cci.z.net, layout=coords, cex=0.6, edge.color="green",
edge.color = coloring, edge.width=cci.weight*1.5, vertex.size=radi*6)
dev.off()
png("cci.z.heatmap.new2.png", width=12, height=4, res=600, units="in")
heatmap.2(cci.z, col=my_palette, trace='none', breaks=colors,
key.xlab=NA, key.title="Z-score", key.ylab=NA, key.xtickfun = NULL, key.ytickfun = NULL,
srtCol=45, adjCol=c(1,0), dendrogram = "both",
margins=c(14,18.5), sepwidth=c(0.01,0.01), symbreaks = TRUE,
sepcolor="grey", colsep=1:length(cancer.name), rowsep=1:length(cancer.name))
dev.off()
pdf("cci.net.pdf", width=8, height=8, paper='special')
plot.igraph(cci.z.net, layout=coords, cex=0.6, edge.color="green",
edge.color = coloring, edge.width=cci.weight*2, vertex.size=radi*6)
dev.off()
color <- rep("NA", times=19)
color[red.id] <- rep("red", times=length(red.id))
color[blue.id] <- rep("orange", times=length(blue.id))
color[black.id] <- rep("grey", times=length(black.id))
V(cci.z.net)$color <- color
pdf("cci.net.pdf", width=8, height=8, paper='special')
plot.igraph(cci.z.net, layout=coords, cex=0.6, edge.color="green",
edge.color = coloring, edge.width=cci.weight*2, vertex.size=radi*6)
dev.off()
png("cci.z.heatmap.new2.png", width=12, height=4, res=600, units="in")
heatmap.2(cci.z, col=my_palette, trace='none', breaks=colors,
key.xlab=NA, key.title="Interaction Z-score", key.ylab=NA, key.xtickfun = NULL, key.ytickfun = NULL,
srtCol=45, adjCol=c(1,0), dendrogram = "both",
margins=c(14,18.5), sepwidth=c(0.01,0.01), symbreaks = TRUE,
sepcolor="grey", colsep=1:length(cancer.name), rowsep=1:length(cancer.name))
dev.off()
png("cci.z.heatmap.new2.png", width=12, height=4, res=600, units="in")
heatmap.2(cci.z, col=my_palette, trace='none', breaks=colors,
key.xlab=NA, key.title="Interaction Z-score Heatmap", key.ylab=NA, key.xtickfun = NULL, key.ytickfun = NULL,
srtCol=45, adjCol=c(1,0), dendrogram = "both",
margins=c(14,18.5), sepwidth=c(0.01,0.01), symbreaks = TRUE,
sepcolor="grey", colsep=1:length(cancer.name), rowsep=1:length(cancer.name))
dev.off()

write.table(cc.suppressed.terms, file="18.PvNP.cc.suppressed.txt", sep="\t", row.names = F, col.names = F, quote=F)
mf.enriched.terms <- c("GO.ID", "GO.Term", "Z-score", "Background")
for (i in 1:length(mf.enrich.list)) {
id <- as.character(mf.enrich.list[i])
term <- Term(GOID(id))
seri <- which(mf.go.cat %in% id)
z.gene <- z.mf[1,seri]
z.back <- z.mf[2,seri]
mf.enriched.terms <- rbind(mf.enriched.terms, c(id, term, z.gene, z.back))
}
mf.enriched.terms
write.table(mf.enriched.terms, file="18.PvNP.mf.enriched.txt", sep="\t", row.names = F, col.names = F, quote=F)
mf.suppressed.terms <- c("GO.ID", "GO.Term", "Z-score", "Background")
for (i in 1:length(mf.suppress.list)) {
id <- as.character(mf.suppress.list[i])
term <- Term(GOID(id))
seri <- which(mf.go.cat %in% id)
z.gene <- z.mf[1,seri]
z.back <- z.mf[2,seri]
mf.suppressed.terms <- rbind(mf.suppressed.terms, c(id, term, z.gene, z.back))
}
mf.suppressed.terms
write.table(mf.suppressed.terms, file="18.PvNP.mf.suppressed.txt", sep="\t", row.names = F, col.names = F, quote=F)
#heat maps
colors = c(seq(-2,2.4,length=10),seq(2.5,15.0,length=10))
my_palette <- colorRampPalette(c("blue2", "red2"))(n = 19)
#my_palette <- colorRampPalette(c("blue2", "red2"))(n = 9)
bp.fig <- z.bp[, which( z.bp[1,] >= 8.64 & z.bp[2,] < 5)]
bp.fig <- bp.fig[,order(bp.fig[1,])]
png(filename = "18.PvNP.bp.top10.png",width=5, height=3.2, res=1200, unit="in")
heatmap.2(bp.fig, col=my_palette, dendrogram='none', breaks=colors,
sepcolor="lightgrey", sepwidth = c(0.05,0.01),
colsep = 1:ncol(bp.z.enrich), rowsep = 1:nrow(bp.z.enrich),
trace='none', Rowv=F, Colv=F, #revC=T, #labCol=NA,
xlab="Biological Process Terms", ylab="",
margins = c(5,3.8), key.title = NA, key.xlab=NA, key.ylab=NA,
scale="none", symbreaks=F, symm=F, symkey = F,
srtCol=45, adjCol=c(0.9,0), adjRow=c(0.2,0), srtRow=45,
cexRow = 0.9, cexCol=0.9,
main="")
dev.off()
mf.fig <- z.mf[, which( z.mf[1,] >= 8.18 & z.mf[2,] < 5)]
mf.fig <- mf.fig[,order(mf.fig[1,])]
png(filename = "18.PvNP.mf.top10.png",width=5, height=3.2, res=1200, unit="in")
heatmap.2(bp.fig, col=my_palette, dendrogram='none', breaks=colors,
sepcolor="lightgrey", sepwidth = c(0.05,0.01),
colsep = 1:ncol(bp.z.enrich), rowsep = 1:nrow(bp.z.enrich),
trace='none', Rowv=F, Colv=F, #revC=T, #labCol=NA,
xlab="Molecular Function Terms", ylab="",
margins = c(5,3.8), key.title = NA, key.xlab=NA, key.ylab=NA,
scale="none", symbreaks=F, symm=F, symkey = F,
srtCol=45, adjCol=c(0.9,0), adjRow=c(0.2,0), srtRow=45,
cexRow = 0.9, cexCol=0.9,
cellnote =
main="")
mf.fig
heatmap.2(bp.fig, col=my_palette, dendrogram='none', breaks=colors,
sepcolor="lightgrey", sepwidth = c(0.05,0.01),
colsep = 1:ncol(bp.z.enrich), rowsep = 1:nrow(bp.z.enrich),
trace='none', Rowv=F, Colv=F, #revC=T, #labCol=NA,
xlab="Biological Process Terms", ylab="",
margins = c(5,3.8), key.title = NA, key.xlab=NA, key.ylab=NA,
scale="none", symbreaks=F, symm=F, symkey = F,
srtCol=45, adjCol=c(0.9,0), adjRow=c(0.2,0), srtRow=45,
cexRow = 0.9, cexCol=0.9,
cellnote = rbind(bp.fig[1,], bp.fig[2,]),
main="")
png(filename = "18.PvNP.bp.top10.png",width=5, height=3.2, res=1200, unit="in")
heatmap.2(bp.fig, col=my_palette, dendrogram='none', breaks=colors,
sepcolor="lightgrey", sepwidth = c(0.05,0.01),
colsep = 1:ncol(bp.z.enrich), rowsep = 1:nrow(bp.z.enrich),
trace='none', Rowv=F, Colv=F, #revC=T, #labCol=NA,
xlab="Biological Process Terms", ylab="",
margins = c(5,3.8), key.title = NA, key.xlab=NA, key.ylab=NA,
scale="none", symbreaks=F, symm=F, symkey = F,
srtCol=45, adjCol=c(0.9,0), adjRow=c(0.2,0), srtRow=45,
cexRow = 0.9, cexCol=0.9,
cellnote = rbind(bp.fig[1,], bp.fig[2,]),
main="")
dev.off()
png(filename = "18.PvNP.bp.top10.png",width=3.2, height=8, res=1200, unit="in")
heatmap.2(bp.fig, col=my_palette, dendrogram='none', breaks=colors,
sepcolor="lightgrey", sepwidth = c(0.05,0.01),
colsep = 1:ncol(bp.z.enrich), rowsep = 1:nrow(bp.z.enrich),
trace='none', Rowv=F, Colv=F, #revC=T, #labCol=NA,
xlab="Biological Process Terms", ylab="",
margins = c(5,3.8), key.title = NA, key.xlab=NA, key.ylab=NA,
scale="none", symbreaks=F, symm=F, symkey = F,
srtCol=45, adjCol=c(0.9,0), adjRow=c(0.2,0), srtRow=45,
cexRow = 0.9, cexCol=0.9,
cellnote = cbind(bp.fig[,1], bp.fig[,2]),
main="")
bp.fig <- z.bp[, which( z.bp[1,] >= 8.64 & z.bp[2,] < 5)]
bp.fig <- t(bp.fig[,order(bp.fig[1,])])
png(filename = "18.PvNP.bp.top10.png",width=3.2, height=8, res=1200, unit="in")
heatmap.2(bp.fig, col=my_palette, dendrogram='none', breaks=colors,
sepcolor="lightgrey", sepwidth = c(0.05,0.01),
colsep = 1:ncol(bp.z.enrich), rowsep = 1:nrow(bp.z.enrich),
trace='none', Rowv=F, Colv=F, #revC=T, #labCol=NA,
xlab="Biological Process Terms", ylab="",
margins = c(5,3.8), key.title = NA, key.xlab=NA, key.ylab=NA,
scale="none", symbreaks=F, symm=F, symkey = F,
srtCol=45, adjCol=c(0.9,0), adjRow=c(0.2,0), srtRow=45,
cexRow = 0.9, cexCol=0.9,
cellnote = cbind(bp.fig[,1], bp.fig[,2]),
main="")
dev.off()
bp.fig <- z.bp[, which( z.bp[1,] >= 8.64 & z.bp[2,] < 5)]
bp.fig <- t(bp.fig[,order(bp.fig[1,])])
png(filename = "18.PvNP.bp.top10.png",width=3.5, height=6, res=1200, unit="in")
heatmap.2(bp.fig, col=my_palette, dendrogram='none', breaks=colors,
sepcolor="lightgrey", sepwidth = c(0.05,0.01),
colsep = 1:ncol(bp.z.enrich), rowsep = 1:nrow(bp.z.enrich),
trace='none', Rowv=F, Colv=F, #revC=T, #labCol=NA,
xlab="Biological Process Terms", ylab="",
margins = c(3.2,5), key.title = NA, key.xlab=NA, key.ylab=NA,
scale="none", symbreaks=F, symm=F, symkey = F,
adjCol=c(0.5,0), adjRow=c(0.2,0), srtRow=45, srtCol=0,
cexRow = 0.9, cexCol=0.9,
cellnote = cbind(bp.fig[,1], bp.fig[,2]),
main="")
dev.off()
bp.fig <- z.bp[, which( z.bp[1,] >= 8.64 & z.bp[2,] < 5)]
bp.fig <- t(bp.fig[,order(-bp.fig[1,])])
png(filename = "18.PvNP.bp.top10.png",width=3.5, height=6, res=1200, unit="in")
heatmap.2(bp.fig, col=my_palette, dendrogram='none', breaks=colors,
sepcolor="lightgrey", sepwidth = c(0.05,0.01),
colsep = 1:ncol(bp.z.enrich), rowsep = 1:nrow(bp.z.enrich),
trace='none', Rowv=F, Colv=F, #revC=T, #labCol=NA,
xlab="Biological Process Terms", ylab="",
margins = c(3.2,5), key.title = NA, key.xlab=NA, key.ylab=NA,
scale="none", symbreaks=F, symm=F, symkey = F,
adjCol=c(0.5,0), adjRow=c(0.2,0), srtRow=45, srtCol=0,
cexRow = 0.9, cexCol=0.9,
cellnote = cbind(bp.fig[,1], bp.fig[,2]),
main="")
dev.off()
colnames(z.bp) <- bp.go.cat
rownames(z.bp) <- c("PANC17", "Background")
colnames(z.cc) <- cc.go.cat
rownames(z.cc) <- c("PANC17", "Background")
colnames(z.mf) <- mf.go.cat
rownames(z.mf) <- c("PANC17", "Background")
bp.fig <- z.bp[, which( z.bp[1,] >= 8.64 & z.bp[2,] < 5)]
bp.fig <- t(bp.fig[,order(-bp.fig[1,])])
png(filename = "18.PvNP.bp.top10.png",width=3.5, height=6, res=1200, unit="in")
heatmap.2(bp.fig, col=my_palette, dendrogram='none', breaks=colors,
sepcolor="lightgrey", sepwidth = c(0.05,0.01),
colsep = 1:ncol(bp.z.enrich), rowsep = 1:nrow(bp.z.enrich),
trace='none', Rowv=F, Colv=F, #revC=T, #labCol=NA,
xlab="Biological Process Terms", ylab="",
margins = c(3.2,5), key.title = NA, key.xlab=NA, key.ylab=NA,
scale="none", symbreaks=F, symm=F, symkey = F,
adjCol=c(0.5,0), adjRow=c(0.2,0), srtRow=45, srtCol=0,
cexRow = 0.9, cexCol=0.9,
cellnote = cbind(bp.fig[,1], bp.fig[,2]),
main="")
dev.off()
mf.fig <- z.mf[, which( z.mf[1,] >= 8.18 & z.mf[2,] < 5)]
mf.fig <- t(mf.fig[,order(mf.fig[1,])])
png(filename = "18.PvNP.mf.top10.png",width=3.5, height=6, res=1200, unit="in")
heatmap.2(bp.fig, col=my_palette, dendrogram='none', breaks=colors,
sepcolor="lightgrey", sepwidth = c(0.05,0.01),
colsep = 1:ncol(bp.z.enrich), rowsep = 1:nrow(bp.z.enrich),
trace='none', Rowv=F, Colv=F, #revC=T, #labCol=NA,
xlab="Molecular Function Terms", ylab="",
margins = c(3.2,5), key.title = NA, key.xlab=NA, key.ylab=NA,
scale="none", symbreaks=F, symm=F, symkey = F,
srtCol=45, adjCol=c(0.9,0), adjRow=c(0.2,0), srtRow=45,
cexRow = 0.9, cexCol=0.9,
cellnote = cbind(mf.fig[1,], mf.fit[,2]),
main="")
mf.fig <- z.mf[, which( z.mf[1,] >= 8.18 & z.mf[2,] < 5)]
mf.fig <- t(mf.fig[,order(mf.fig[1,])])
png(filename = "18.PvNP.mf.top10.png",width=3.5, height=6, res=1200, unit="in")
heatmap.2(bp.fig, col=my_palette, dendrogram='none', breaks=colors,
sepcolor="lightgrey", sepwidth = c(0.05,0.01),
colsep = 1:ncol(bp.z.enrich), rowsep = 1:nrow(bp.z.enrich),
trace='none', Rowv=F, Colv=F, #revC=T, #labCol=NA,
xlab="Molecular Function Terms", ylab="",
margins = c(3.2,5), key.title = NA, key.xlab=NA, key.ylab=NA,
scale="none", symbreaks=F, symm=F, symkey = F,
srtCol=45, adjCol=c(0.9,0), adjRow=c(0.2,0), srtRow=45,
cexRow = 0.9, cexCol=0.9,
cellnote = cbind(mf.fig[1,], mf.fig[,2]),
main="")
dev.off()
png(filename = "18.PvNP.mf.top10.png",width=3.5, height=6, res=1200, unit="in")
heatmap.2(bp.fig, col=my_palette, dendrogram='none', breaks=colors,
sepcolor="lightgrey", sepwidth = c(0.05,0.01),
colsep = 1:ncol(bp.z.enrich), rowsep = 1:nrow(bp.z.enrich),
trace='none', Rowv=F, Colv=F, #revC=T, #labCol=NA,
xlab="Molecular Function Terms", ylab="",
margins = c(3.2,5), key.title = NA, key.xlab=NA, key.ylab=NA,
scale="none", symbreaks=F, symm=F, symkey = F,
adjCol=c(0.5,0), adjRow=c(0.2,0), srtRow=45, srtCol=0,
cexRow = 0.9, cexCol=0.9,
cellnote = cbind(mf.fig[1,], mf.fig[,2]),
main="")
dev.off()
png(filename = "18.PvNP.mf.top10.png",width=3.5, height=6, res=1200, unit="in")
heatmap.2(bp.fig, col=my_palette, dendrogram='none', breaks=colors,
sepcolor="lightgrey", sepwidth = c(0.05,0.01),
colsep = 1:ncol(bp.z.enrich), rowsep = 1:nrow(bp.z.enrich),
trace='none', Rowv=F, Colv=F, #revC=T, #labCol=NA,
ylab="Molecular Function Terms", xlab="",
margins = c(3.2,5), key.title = NA, key.xlab=NA, key.ylab=NA,
scale="none", symbreaks=F, symm=F, symkey = F,
adjCol=c(0.5,0), adjRow=c(0.2,0), srtRow=45, srtCol=0,
cexRow = 0.9, cexCol=0.9,
cellnote = cbind(mf.fig[1,], mf.fig[,2]),
main="")
dev.off()
mf.fig <- z.mf[, which( z.mf[1,] >= 8.18)]
mf.fig <- t(mf.fig[,order(mf.fig[1,])])
png(filename = "18.PvNP.mf.top10.png",width=3.5, height=6, res=1200, unit="in")
heatmap.2(bp.fig, col=my_palette, dendrogram='none', breaks=colors,
sepcolor="lightgrey", sepwidth = c(0.05,0.01),
colsep = 1:ncol(bp.z.enrich), rowsep = 1:nrow(bp.z.enrich),
trace='none', Rowv=F, Colv=F, #revC=T, #labCol=NA,
ylab="Molecular Function Terms", xlab="",
margins = c(3.2,5), key.title = NA, key.xlab=NA, key.ylab=NA,
scale="none", symbreaks=F, symm=F, symkey = F,
adjCol=c(0.5,0), adjRow=c(0.2,0), srtRow=45, srtCol=0,
cexRow = 0.9, cexCol=0.9,
cellnote = cbind(mf.fig[,1], mf.fig[,2]),
main="")
dev.off()
mf.fig <- z.mf[, which( z.mf[1,] >= 8.18)]
mf.fig <- t(mf.fig[,order(-mf.fig[1,])])
png(filename = "18.PvNP.mf.top10.png",width=3.5, height=6, res=1200, unit="in")
heatmap.2(bp.fig, col=my_palette, dendrogram='none', breaks=colors,
sepcolor="lightgrey", sepwidth = c(0.05,0.01),
colsep = 1:ncol(bp.z.enrich), rowsep = 1:nrow(bp.z.enrich),
trace='none', Rowv=F, Colv=F, #revC=T, #labCol=NA,
ylab="Molecular Function Terms", xlab="",
margins = c(3.2,5), key.title = NA, key.xlab=NA, key.ylab=NA,
scale="none", symbreaks=F, symm=F, symkey = F,
adjCol=c(0.5,0), adjRow=c(0.2,0), srtRow=45, srtCol=0,
cexRow = 0.9, cexCol=0.9,
cellnote = cbind(mf.fig[,1], mf.fig[,2]),
main="")
dev.off()
#calcualting z-scores and plotting heatmaps
bp.hspin <- matrix(as.numeric(unlist(read.table("18.PvNP.bp.csv", header=F, sep=","))), nrow=bp.dim, ncol=2)
bp.obs <- c(bp.hspin)
cc.hspin <- matrix(as.numeric(unlist(read.table("18.PvNP.cc.csv", header=F, sep=","))), nrow=cc.dim, ncol=2)
cc.obs <- c(cc.hspin)
mf.hspin <- matrix(as.numeric(unlist(read.table("18.PvNP.mf.csv", header=F, sep=","))), nrow=mf.dim, ncol=2)
mf.obs <- c(mf.hspin)
bp.perm <- c()
cc.perm <- c()
mf.perm <- c()
for (i in 1:100) {
bp.name <- paste("ms02.human", "/", "18.PvNP", "/", "ms02.", i, ".bp.matrix.csv", sep="")
cc.name <- paste("ms02.human", "/", "18.PvNP", "/", "ms02.", i, ".cc.matrix.csv", sep="")
mf.name <- paste("ms02.human", "/", "18.PvNP", "/", "ms02.", i, ".mf.matrix.csv", sep="")
bp.mat <- matrix(as.numeric(unlist(read.table(bp.name, header=F, sep=","))), nrow=bp.dim, ncol=2)
cc.mat <- matrix(as.numeric(unlist(read.table(cc.name, header=F, sep=","))), nrow=cc.dim, ncol=2)
mf.mat <- matrix(as.numeric(unlist(read.table(mf.name, header=F, sep=","))), nrow=mf.dim, ncol=2)
bp.perm <- rbind(bp.perm, c(bp.mat))
cc.perm <- rbind(cc.perm, c(cc.mat))
mf.perm <- rbind(mf.perm, c(mf.mat))
}
bp.mean <- colMeans(bp.perm)
bp.std <- colSds(bp.perm)
cc.mean <- colMeans(cc.perm)
cc.std <- colSds(cc.perm)
mf.mean <- colMeans(mf.perm)
mf.std <- colSds(mf.perm)
bp.zscore <- round((bp.obs - bp.mean)/bp.std, 3)
cc.zscore <- round((cc.obs - cc.mean)/cc.std, 3)
mf.zscore <- round((mf.obs - mf.mean)/mf.std, 3)
z.bp <- matrix(bp.zscore, nrow=bp.dim, ncol=2)
z.cc <- matrix(cc.zscore, nrow=cc.dim, ncol=2)
z.mf <- matrix(mf.zscore, nrow=mf.dim, ncol=2)
z.bp <- t(z.bp)
z.cc <- t(z.cc)
z.mf <- t(z.mf)
colnames(z.bp) <- bp.go.cat
rownames(z.bp) <- c("PANC17", "Background")
colnames(z.cc) <- cc.go.cat
rownames(z.cc) <- c("PANC17", "Background")
colnames(z.mf) <- mf.go.cat
rownames(z.mf) <- c("PANC17", "Background")
bp.z.enrich <- z.bp[, which( z.bp[1,] >= 5 & z.bp[2,] < 5)]
bp.z.enrich <- bp.z.enrich[,order(bp.z.enrich[1,])]
bp.enrich.list <- colnames(bp.z.enrich)
cc.z.enrich <- z.cc[, which( z.cc[1,] >= 5 & z.cc[2,] < 5)]
cc.z.enrich <- cc.z.enrich[,order(cc.z.enrich[1,])]
cc.enrich.list <- colnames(cc.z.enrich)
mf.z.enrich <- z.mf[, which( z.mf[1,] >= 5 & z.mf[2,] < 5)]
mf.z.enrich <- mf.z.enrich[,order(mf.z.enrich[1,])]
mf.enrich.list <- colnames(mf.z.enrich)
bp.z.suppress <- z.bp[, which( z.bp[1,] <= -5 & z.bp[2,] > -5)]
bp.z.suppress <- bp.z.suppress[,order(-bp.z.suppress[1,])]
bp.suppress.list <- colnames(bp.z.suppress)
cc.z.suppress <- z.cc[, which(z.cc[1,] <= -5 & z.cc[2,] > -5)]
cc.z.suppress <- cc.z.suppress[,order(-cc.z.suppress[1,])]
cc.suppress.list <- colnames(cc.z.suppress)
mf.z.suppress <- z.mf[, which(z.mf[1,] <= -5 & z.mf[2,] > -5)]
mf.z.suppress <- mf.z.suppress[,order(-mf.z.suppress[1,])]
mf.suppress.list <- colnames(mf.z.suppress)
bp.enriched.terms <- c("GO.ID", "GO.Term", "PANC17", "Background")
for (i in 1:length(bp.enrich.list)) {
id <- as.character(bp.enrich.list[i])
term <- Term(GOID(id))
seri <- which(bp.go.cat %in% id)
z.gene <- z.bp[1,seri]
z.back <- z.bp[2,seri]
bp.enriched.terms <- rbind(bp.enriched.terms, c(id, term, z.gene, z.back))
}
bp.enriched.terms
write.table(bp.enriched.terms, file="18.PvNP.bp.enriched.txt", sep="\t", row.names = F, col.names = F, quote=F)
bp.suppressed.terms <- c("GO.ID", "GO.Term", "PANC17", "Background")
for (i in 1:length(bp.suppress.list)) {
id <- as.character(bp.suppress.list[i])
term <- Term(GOID(id))
seri <- which(bp.go.cat %in% id)
z.gene <- z.bp[1,seri]
z.back <- z.bp[2,seri]
bp.suppressed.terms <- rbind(bp.suppressed.terms, c(id, term, z.gene, z.back))
}
bp.suppressed.terms
write.table(bp.suppressed.terms, file="18.PvNP.bp.suppressed.txt", sep="\t", row.names = F, col.names = F, quote=F)
cc.enriched.terms <- c("GO.ID", "GO.Term", "PANC17", "Background")
for (i in 1:length(cc.enrich.list)) {
id <- as.character(cc.enrich.list[i])
term <- Term(GOID(id))
seri <- which(cc.go.cat %in% id)
z.gene <- z.cc[1,seri]
z.back <- z.cc[2,seri]
cc.enriched.terms <- rbind(cc.enriched.terms, c(id, term, z.gene, z.back))
}
cc.enriched.terms
write.table(cc.enriched.terms, file="18.PvNP.cc.enriched.txt", sep="\t", row.names = F, col.names = F, quote=F)
cc.suppressed.terms <- c("GO.ID", "GO.Term", "PANC17", "Background")
for (i in 1:length(cc.suppress.list)) {
id <- as.character(cc.suppress.list[i])
term <- Term(GOID(id))
seri <- which(cc.go.cat %in% id)
z.gene <- z.cc[1,seri]
z.back <- z.cc[2,seri]
cc.suppressed.terms <- rbind(cc.suppressed.terms, c(id, term, z.gene, z.back))
}
cc.suppressed.terms
write.table(cc.suppressed.terms, file="18.PvNP.cc.suppressed.txt", sep="\t", row.names = F, col.names = F, quote=F)
mf.enriched.terms <- c("GO.ID", "GO.Term", "PANC17", "Background")
for (i in 1:length(mf.enrich.list)) {
id <- as.character(mf.enrich.list[i])
term <- Term(GOID(id))
seri <- which(mf.go.cat %in% id)
z.gene <- z.mf[1,seri]
z.back <- z.mf[2,seri]
mf.enriched.terms <- rbind(mf.enriched.terms, c(id, term, z.gene, z.back))
}
mf.enriched.terms
write.table(mf.enriched.terms, file="18.PvNP.mf.enriched.txt", sep="\t", row.names = F, col.names = F, quote=F)
mf.suppressed.terms <- c("GO.ID", "GO.Term", "PANC17", "Background")
for (i in 1:length(mf.suppress.list)) {
id <- as.character(mf.suppress.list[i])
term <- Term(GOID(id))
seri <- which(mf.go.cat %in% id)
z.gene <- z.mf[1,seri]
z.back <- z.mf[2,seri]
mf.suppressed.terms <- rbind(mf.suppressed.terms, c(id, term, z.gene, z.back))
}
mf.suppressed.terms
write.table(mf.suppressed.terms, file="18.PvNP.mf.suppressed.txt", sep="\t", row.names = F, col.names = F, quote=F)
#heat maps
colors = c(seq(-2,2.4,length=10),seq(2.5,15.0,length=10))
my_palette <- colorRampPalette(c("blue2", "red2"))(n = 19)
#my_palette <- colorRampPalette(c("blue2", "red2"))(n = 9)
bp.fig <- z.bp[, which( z.bp[1,] >= 8.64 & z.bp[2,] < 5)]
bp.fig <- t(bp.fig[,order(-bp.fig[1,])])
png(filename = "18.PvNP.bp.top10.png",width=3.5, height=6, res=1200, unit="in")
heatmap.2(bp.fig, col=my_palette, dendrogram='none', breaks=colors,
sepcolor="lightgrey", sepwidth = c(0.05,0.01),
colsep = 1:ncol(bp.z.enrich), rowsep = 1:nrow(bp.z.enrich),
trace='none', Rowv=F, Colv=F, #revC=T, #labCol=NA,
ylab="Biological Process Terms", xlab="",
margins = c(3.2,5), key.title = NA, key.xlab=NA, key.ylab=NA,
scale="none", symbreaks=F, symm=F, symkey = F,
adjCol=c(0.5,0), adjRow=c(0.2,0), srtRow=45, srtCol=0,
cexRow = 0.9, cexCol=0.9,
cellnote = cbind(bp.fig[,1], bp.fig[,2]),
main="")
dev.off()
mf.fig <- z.mf[, which( z.mf[1,] >= 8.18)]
mf.fig <- t(mf.fig[,order(-mf.fig[1,])])
png(filename = "18.PvNP.mf.top10.png",width=3.5, height=6, res=1200, unit="in")
heatmap.2(bp.fig, col=my_palette, dendrogram='none', breaks=colors,
sepcolor="lightgrey", sepwidth = c(0.05,0.01),
colsep = 1:ncol(bp.z.enrich), rowsep = 1:nrow(bp.z.enrich),
trace='none', Rowv=F, Colv=F, #revC=T, #labCol=NA,
ylab="Molecular Function Terms", xlab="",
margins = c(3.2,5), key.title = NA, key.xlab=NA, key.ylab=NA,
scale="none", symbreaks=F, symm=F, symkey = F,
adjCol=c(0.5,0), adjRow=c(0.2,0), srtRow=45, srtCol=0,
cexRow = 0.9, cexCol=0.9,
cellnote = cbind(mf.fig[,1], mf.fig[,2]),
main="")
dev.off()
cc.fig <- z.cc[, which( z.cc[1,] >= 7.15)]
cc.fig <- cc.fig[,order(-cc.fig[1,])]
png(filename = "18.PvNP.cc.top10.png",width=3.5, height=6, res=1200, unit="in")
heatmap.2(bp.fig, col=my_palette, dendrogram='none', breaks=colors,
sepcolor="lightgrey", sepwidth = c(0.05,0.01),
colsep = 1:ncol(bp.z.enrich), rowsep = 1:nrow(bp.z.enrich),
trace='none', Rowv=F, Colv=F, #revC=T, #labCol=NA,
ylab="Cellular Component Terms", xlab="",
margins = c(5,3.8), key.title = NA, key.xlab=NA, key.ylab=NA,
scale="none", symbreaks=F, symm=F, symkey = F,
adjCol=c(0.5,0), adjRow=c(0.2,0), srtRow=45, srtCol=0,
cexRow = 0.9, cexCol=0.9,
cellnote = cbind(cc.fig[,1], cc.fig[,2]),
main="")
cc.fig <- z.cc[, which( z.cc[1,] >= 7.15)]
cc.fig <- cc.fig[,order(-cc.fig[1,])]
png(filename = "18.PvNP.cc.top10.png",width=3.5, height=6, res=1200, unit="in")
heatmap.2(cc.fig, col=my_palette, dendrogram='none', breaks=colors,
sepcolor="lightgrey", sepwidth = c(0.05,0.01),
colsep = 1:ncol(bp.z.enrich), rowsep = 1:nrow(bp.z.enrich),
trace='none', Rowv=F, Colv=F, #revC=T, #labCol=NA,
ylab="Cellular Component Terms", xlab="",
margins = c(3.2,5), key.title = NA, key.xlab=NA, key.ylab=NA,
scale="none", symbreaks=F, symm=F, symkey = F,
adjCol=c(0.5,0), adjRow=c(0.2,0), srtRow=45, srtCol=0,
cexRow = 0.9, cexCol=0.9,
cellnote = cbind(cc.fig[,1], cc.fig[,2]),
main="")
cc.fig
mf.fig
cc.fig <- z.cc[, which( z.cc[1,] >= 7.15)]
cc.fig <- t(cc.fig[,order(-cc.fig[1,])])
png(filename = "18.PvNP.cc.top10.png",width=3.5, height=6, res=1200, unit="in")
heatmap.2(cc.fig, col=my_palette, dendrogram='none', breaks=colors,
sepcolor="lightgrey", sepwidth = c(0.05,0.01),
colsep = 1:ncol(bp.z.enrich), rowsep = 1:nrow(bp.z.enrich),
trace='none', Rowv=F, Colv=F, #revC=T, #labCol=NA,
ylab="Cellular Component Terms", xlab="",
margins = c(3.2,5), key.title = NA, key.xlab=NA, key.ylab=NA,
scale="none", symbreaks=F, symm=F, symkey = F,
adjCol=c(0.5,0), adjRow=c(0.2,0), srtRow=45, srtCol=0,
cexRow = 0.9, cexCol=0.9,
cellnote = cbind(cc.fig[,1], cc.fig[,2]),
main="")
dev.off()
cc.fig <- z.cc[, which( z.cc[1,] >= 8.59)]
cc.fig <- t(cc.fig[,order(-cc.fig[1,])])
png(filename = "18.PvNP.cc.top10.png",width=3.5, height=6, res=1200, unit="in")
heatmap.2(cc.fig, col=my_palette, dendrogram='none', breaks=colors,
sepcolor="lightgrey", sepwidth = c(0.05,0.01),
colsep = 1:ncol(bp.z.enrich), rowsep = 1:nrow(bp.z.enrich),
trace='none', Rowv=F, Colv=F, #revC=T, #labCol=NA,
ylab="Cellular Component Terms", xlab="",
margins = c(3.2,5), key.title = NA, key.xlab=NA, key.ylab=NA,
scale="none", symbreaks=F, symm=F, symkey = F,
adjCol=c(0.5,0), adjRow=c(0.2,0), srtRow=45, srtCol=0,
cexRow = 0.9, cexCol=0.9,
cellnote = cbind(cc.fig[,1], cc.fig[,2]),
main="")
dev.off()
mf.fig <- z.mf[, which( z.mf[1,] >= 8.18)]
mf.fig <- t(mf.fig[,order(-mf.fig[1,])])
png(filename = "18.PvNP.mf.top10.png",width=3.5, height=6, res=1200, unit="in")
heatmap.2(mf.fig, col=my_palette, dendrogram='none', breaks=colors,
sepcolor="lightgrey", sepwidth = c(0.05,0.01),
colsep = 1:ncol(bp.z.enrich), rowsep = 1:nrow(bp.z.enrich),
trace='none', Rowv=F, Colv=F, #revC=T, #labCol=NA,
ylab="Molecular Function Terms", xlab="",
margins = c(3.2,5), key.title = NA, key.xlab=NA, key.ylab=NA,
scale="none", symbreaks=F, symm=F, symkey = F,
adjCol=c(0.5,0), adjRow=c(0.2,0), srtRow=45, srtCol=0,
cexRow = 0.9, cexCol=0.9,
cellnote = cbind(mf.fig[,1], mf.fig[,2]),
main="")
dev.off()
mf.obs
length(mf.obs)
length(mf.mean)
which(mf.go.cat %in% "GO:0005109")
z.mf[124]
mf.zscore[124]
mf.obs[15.947]
mf.mean[15.947]
mf.std[124]
(357-314.22)/5.767297
mf.mean[124]
mf.obs[124]
mf.std[124]
(139-47.03)/5.767297
z.mf
z.mf[124]
z.mf[124,]
z.mf
z.mf[,124]
mf.obs[,124]
mf.obs[124,]
mf.obs[124]
mf.mean[,124]
mf.mean[124,]
mf.mean[124]
mf.zscore
length(mf.zscore)
mf.zscore[124]
mf.zscore[(124+392)]
z.mf[,124]
mf.obs[(124+392)]
mf.mean[(124+392)]
mf.std[(124+392)]
mf.std[124]
